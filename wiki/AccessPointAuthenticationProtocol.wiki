#summary Documents the AP Authentication Protocol.
#labels Phase-Design
= Introduction =

This page documents the Access Point Authentication Protocol  used by the Motorola Canopy wireless system.

The information on this page was deduced by changing settings in Prizm (the standard AP authentication server from Motorola) and using Wireshark to watch network traffic between Prizm and the AP on my test network. You can read my notes and download the pcap files from my experimentation at http://jungleauth.googlecode.com/svn/trunk/protocol-samples/

= Protocol Description =

==General==

Communication is via UDP traffic from port 61001 to port 1234.
  * AP: Access Point
  * APAS: Access Point Authentication Server

==Access Point Registration==

From AP to APAS, meaning unknown: 
|| 45000000000000034300000000000000000000000000 ||

==Subscriber Module Registration==
[http://jungleauth.googlecode.com/svn/trunk/protocol-samples/sm%20config%201.txt BAM config], [http://jungleauth.googlecode.com/svn/trunk/protocol-samples/sm%20config%201%20allowed%20try%201.pcap packet capture]

===SM is allowed to register===
====Authentication request from AP to APAS====
|| Unknown || SM MAC || AP MAC || Unknown || LUID || Unknown || Sequence number ||
|| 01 || 0A003EF05227 || 0A003EF0458C || 0004 || 02 || 0000 || 0000 ||

====Challenge from APAS to AP====
|| Unknown || SM MAC || Unknown ||
|| 2304000000000000000000370000000100000006 || 0a003ef05227 || 0000000300000001000000000400000010000012ec000016fc00006ba200005b600000000000000000 ||

====Challenge response from AP to APAS====
|| Unknown || SM MAC || Unknown || AP MAC || Unknown ||
|| 2404000200000000000000560000000100000006 || 0a003ef05227 || 000000060000002000000000000000000000000000000000000000000000000000000000000000000000000200000006 || 0a003ef0458c || 0000000500000006d6bb98d8cb5e00000000 || 

====Authentication grant from APAS to AP====
|| Unknown A || SM MAC || Unknown B || Unknown C || QoS preamble || [QoSString QoS string] ||
|| 2504000000000000000000670000000100000006 || 0a003ef05227 || 0000000300000001000000000700000018 || ab8d3702bcc7d757280a7d7848f32e5910bf994e739517c || 60000000600000020 || 008000800007a1200007a12000000000000000000000000000000000000000000000000000000000 ||

====Unknown====
From AP to APAS:
|| Unknown || SM MAC || Unknown ||
|| 450000000200000141000000 || 0a003ef05227 || 0000001b0000003200000001000000003300000001000000005a0000000101 ||

From APAS to AP:
|| Unknown ||
|| 4600000002000001 ||

From APAS to AP:
|| Unknown || SM MAC || Unknown ||
|| 450000000000000442000000 || 0a003ef05227 || 000000670000000e000000020dac0000000f000000040007a12000000010000000020dac00000011000000040007a120000000090000000200000000000a0000000200000000000b0000000200000000000c0000000200000000000d000000010000000037000000020002 ||

From AP to APAS:
|| Unknown ||
|| 4600000000000004 ||

===SM is not allowed to register===
====Authentication request from AP to APAS====
|| Unknown || SM MAC || AP MAC || Unknown || LUID || Unknown || Sequence number ||
|| 01 || 0A003EF05227 || 0A003EF0458C || 0004 || 02 || 0000 || 0000 ||

====Rejection response from APAS to AP====
|| Unknown || Sequence number || Unknown || SM MAC || Unknown ||
||  230400000000 || 0004 || 000000370000000100000006 || 0a003ef05227 || 0000000300000001010000000400000010000000000000000000000000000000000000000000000000 ||

==Subscriber Module Disconnection==

===Voluntary===

===Forced===